
\subsection{Faster Candidate Motif Elimination through Block Processing}

The EMS-GT algorithm tests candidate motifs in a brute-force approach. A candidate motif is tested by checking if each of the remaining $(n - n')$ sequences contains an $l$-mer that has at most $d$ hamming distance value with the candidate motif. In testing a candidate motif $c$, if there is a sequence $S_i$ in $(n - n')$ that has no $l$-mer with hamming distance of at most $d$ with $c$, the candidate motif $c$ is automatically eliminated.

Since the search space is represented by a compressed bit array and the $l$-mers are enumerated alphabetically, $l$-mers that are near each other share the same $p$-length prefix string. We used this observation in improving the way the algorithm tests the candidate motifs. In EMS-GT, each testing of candidate motif is independent of each other. We proposed a speedup technique that processes these candidate motifs by block. Dividing the search space and grouping the $l$-mers by fix block $k$ will result into a group of $l$-mers that has the same $(l - k)$-length prefix where $k < l$. We can easily observe that increasing the value of $k$-block size will increase the number of $l$-mers in a group but decreases the length of the common prefix string they share. If candidate motifs $x$ and $y$ are within $k$-block and $x$ has been eliminated as a candidate motif in sequence $S_i$ $(n' \leq i \leq n)$, we can filter out $l$-mers $z \in S_i$ where $d_H(x,z) > d + k$. We collect the remaining $l$-mers in $S_i$ and use it for testing the remaining candidate motifs in the block along with the other $l$-mers in the remaining sequences. 

\begin{thm} \label{thm:triangle}
	Let x and y be $l$-mers in a $k$-size block in the search space and $d_H(x, y) \leq k$. Let $d$ be the number of allowed mutations in the problem. Let z be another $l$-mer. If $d_H(x, z) > (d + k)$ then $d_H(y, z) > d$ and $z \not\in N(y, d)$
\end{thm}

\begin{proof}[Proof of Theorem \ref{thm:triangle}]
Using proof by contradiction, suppose that $d_H(y, z) \leq d$. We know that $d_H(x, z) < d_H(y, z) + d_H(x, y)$ from the triangle inequality. We can write this equation into $d_H(x, z) < d + k$ thus a contradiction to the previous assumption that $d_H(x, z) > (d + k)$.
\end{proof}